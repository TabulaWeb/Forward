{% extends "shop/base.html" %}
{% load static %}

{% block title %}Your shopping cart{% endblock %}

{% block content %}
        {% if sent == true %}
        <div class="block_mini-form">
            <div class="reg_mini-form">
                <form class="mini_form" method="post">
                    <div class="content_mini-form">
                        <svg class="close_form-mini" fill="#babac0" enable-background="new 0 0 32 32" height="32px" id="Слой_1" version="1.1" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Cancel"><path clip-rule="evenodd" d="M16,0C7.163,0,0,7.163,0,16c0,8.836,7.163,16,16,16   c8.836,0,16-7.163,16-16C32,7.163,24.836,0,16,0z M16,30C8.268,30,2,23.732,2,16C2,8.268,8.268,2,16,2s14,6.268,14,14   C30,23.732,23.732,30,16,30z" fill="#babac0" fill-rule="evenodd"/><path clip-rule="evenodd" d="M22.729,21.271l-5.268-5.269l5.238-5.195   c0.395-0.391,0.395-1.024,0-1.414c-0.394-0.39-1.034-0.39-1.428,0l-5.231,5.188l-5.309-5.31c-0.394-0.396-1.034-0.396-1.428,0   c-0.394,0.395-0.394,1.037,0,1.432l5.301,5.302l-5.331,5.287c-0.394,0.391-0.394,1.024,0,1.414c0.394,0.391,1.034,0.391,1.429,0   l5.324-5.28l5.276,5.276c0.394,0.396,1.034,0.396,1.428,0C23.123,22.308,23.123,21.667,22.729,21.271z" fill="#babac0" fill-rule="evenodd"/></g><g/><g/><g/><g/><g/><g/></svg>
                        <h3>Заполните форму и мы Вам перезвоним</h3>
                        {% csrf_token %}
                        {{ form }}
                        <button type="submit">Отправить</button>

                        <div class="block_mini-true">
                            <p>Сообщение успешно отправлено</p>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        {% else %}
        <div class="block_mini-form">
            <div class="reg_mini-form">
                <form class="mini_form" method="post">
                    <div class="content_mini-form">
                        <svg class="close_form-mini" fill="#babac0" enable-background="new 0 0 32 32" height="32px" id="Слой_1" version="1.1" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Cancel"><path clip-rule="evenodd" d="M16,0C7.163,0,0,7.163,0,16c0,8.836,7.163,16,16,16   c8.836,0,16-7.163,16-16C32,7.163,24.836,0,16,0z M16,30C8.268,30,2,23.732,2,16C2,8.268,8.268,2,16,2s14,6.268,14,14   C30,23.732,23.732,30,16,30z" fill="#babac0" fill-rule="evenodd"/><path clip-rule="evenodd" d="M22.729,21.271l-5.268-5.269l5.238-5.195   c0.395-0.391,0.395-1.024,0-1.414c-0.394-0.39-1.034-0.39-1.428,0l-5.231,5.188l-5.309-5.31c-0.394-0.396-1.034-0.396-1.428,0   c-0.394,0.395-0.394,1.037,0,1.432l5.301,5.302l-5.331,5.287c-0.394,0.391-0.394,1.024,0,1.414c0.394,0.391,1.034,0.391,1.429,0   l5.324-5.28l5.276,5.276c0.394,0.396,1.034,0.396,1.428,0C23.123,22.308,23.123,21.667,22.729,21.271z" fill="#babac0" fill-rule="evenodd"/></g><g/><g/><g/><g/><g/><g/></svg>
                        <h3>Заполните форму и мы Вам перезвоним</h3>
                        {% csrf_token %}
                        {{ form }}
                        <button type="submit">Отправить</button>
                    </div>
                </form>
            </div>
        </div>
        {% endif %}
    <div class="page_cart">
        <h1>Корзина</h1>
        <div class="blocks_items-cart">
                {% for item in cart %}
                    {% with product=item.product %}
                    <div class="block_item-cart">
                        <div class="item_cart-img">
                            <a href="{{ product.get_absolute_url }}">
                                <img src="{% if product.image %}{{ product.image.url }}
                                        {% else %}{% static "img/no_image.png" %}{% endif %}">
                            </a>
                        </div>
                        <div class="item_cart-manipul">
                            <div>
                                <div class="item_cart-name">{{ product.name }}</div>
                                <div class="item_cart-remove"><a href="{% url "cart:cart_remove" product.id%}"><svg fill="#babac0" class="svg_trash" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path class="cls-1" d="M24,31H8a3,3,0,0,1-3-3V9A1,1,0,0,1,7,9V28a1,1,0,0,0,1,1H24a1,1,0,0,0,1-1V9a1,1,0,0,1,2,0V28A3,3,0,0,1,24,31Z"/><path class="cls-1" d="M28,7H4A1,1,0,0,1,4,5H28a1,1,0,0,1,0,2Z"/><path class="cls-1" d="M20,7a1,1,0,0,1-1-1V3H13V6a1,1,0,0,1-2,0V2a1,1,0,0,1,1-1h8a1,1,0,0,1,1,1V6A1,1,0,0,1,20,7Z"/><path class="cls-1" d="M16,26a1,1,0,0,1-1-1V11a1,1,0,0,1,2,0V25A1,1,0,0,1,16,26Z"/><path class="cls-1" d="M21,24a1,1,0,0,1-1-1V13a1,1,0,0,1,2,0V23A1,1,0,0,1,21,24Z"/><path class="cls-1" d="M11,24a1,1,0,0,1-1-1V13a1,1,0,0,1,2,0V23A1,1,0,0,1,11,24Z"/></g></svg></a></div>
                            </div>
                            <div>
                                <div class="item_cart-price">
                                    <div class="item-totalPrice">
                                        {{ item.total_price }} ₽
                                    </div>
                                    <div class="item_price">
                                        {{ item.quantity }} <span>x</span> {{ item.price }} ₽
                                    </div>
                                </div>
                                <div class="item_cart-quantity">
                                    <form action="{% url "cart:cart_add" product.id %}" method="post">
                                        {{ item.update_quantity_form.quantity }}
                                        {{ item.update_quantity_form.update }}
                                        <input type="submit" value="Update">
                                        {% csrf_token %}
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>    
                    {% endwith %}
                {% endfor %}
        </div>
        <div class="orders-list__content">
            <p>Сумма к оплате <span>{{ cart.get_total_price }} ₽</span></p>
            <div class="orders-list__button">
                <a href="{% url "orders:order_create" %}" class="button">Оформить заказ</a>
                <a href="{% url "shop:product_list" %}" class="button light">Вернуться к покупкам</a>
            </div>
        </div>
        <p class="text-right">
            
            
        </p>
    </div>
{% endblock %}
